# Published ë…¸íŠ¸ ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ

## ê¸°ë³¸ ê¸°ëŠ¥

- **getPublishedFileTree**: publishedë¡œ ë°”ë€ŒëŠ” ê²½ë¡œ, published ë…¸íŠ¸ íŒŒì¼ íŠ¸ë¦¬ ì¡°íšŒ
- **unPublishedLibrary**: publishedì—ì„œ privateìœ¼ë¡œ ë³€ê²½, DB ë ˆì½”ë“œ ì‚­ì œ + GCS published í´ë” ì‚­ì œ

---

# ì¶”ê°€ êµ¬í˜„ ê¸°ëŠ¥

## ğŸ”— ì—°ê²° ê¸°ëŠ¥ (Link Features)

### 1. Published ë…¸íŠ¸ ì—°ê²°

```typescript
POST /:libraryName/published/link
Body: { "toUserId": "string", "toLibraryName": "string" }
```

- **ëª©ì **: ë‹¤ë¥¸ ì‚¬ìš©ìì˜ Published ë…¸íŠ¸ì™€ ì—°ê²°
- **ê¶Œí•œ**: ë¡œê·¸ì¸ í•„ìˆ˜ (JwtAuthGuard)
- **ë™ì‘**:
  - ì—°ê²° ëŒ€ìƒ ë…¸íŠ¸ê°€ Published ìƒíƒœì¸ì§€ í™•ì¸
  - ì—°ê²° ì •ë³´ë¥¼ DBì— ì €ì¥ (í–¥í›„ êµ¬í˜„ ì˜ˆì •)

### 2. ì—°ê²°ëœ ë…¸íŠ¸ ëª©ë¡ ì¡°íšŒ

```typescript
GET /:libraryName/published/links
```

- **ëª©ì **: í˜„ì¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì—°ê²°ëœ ë…¸íŠ¸ë“¤ ì¡°íšŒ
- **ê¶Œí•œ**: ë¡œê·¸ì¸ í•„ìˆ˜ (JwtAuthGuard)
- **ë°˜í™˜**: ì—°ê²°ëœ ë…¸íŠ¸ ëª©ë¡ ë°°ì—´

### 3. ë…¸íŠ¸ ì—°ê²° í•´ì œ

```typescript
DELETE /:libraryName/published/links/:linkedNoteId
```

- **ëª©ì **: ê¸°ì¡´ ì—°ê²°ì„ í•´ì œ
- **ê¶Œí•œ**: ë¡œê·¸ì¸ í•„ìˆ˜ (JwtAuthGuard)
- **ë™ì‘**: íŠ¹ì • ì—°ê²° IDë¥¼ í†µí•´ ì—°ê²° ì œê±°

## ğŸ” ê²€ìƒ‰ ê¸°ëŠ¥ (Search Features)

### 4. Published ë…¸íŠ¸ ê²€ìƒ‰

```typescript
GET /search/published?q=ê²€ìƒ‰ì–´&userId=íŠ¹ì •ì‚¬ìš©ì&limit=ê²°ê³¼ìˆ˜
```

- **ëª©ì **: í‚¤ì›Œë“œë¡œ Published ë…¸íŠ¸ ê²€ìƒ‰
- **ê¶Œí•œ**: ì„ íƒì  ë¡œê·¸ì¸ (OptionalAuthGuard)
- **íŒŒë¼ë¯¸í„°**:
  - `q`: ê²€ìƒ‰ì–´ (í•„ìˆ˜)
  - `userId`: íŠ¹ì • ì‚¬ìš©ì ë…¸íŠ¸ë§Œ ê²€ìƒ‰ (ì„ íƒ)
  - `limit`: ê²°ê³¼ ìˆ˜ ì œí•œ (ê¸°ë³¸ê°’: 20)

### 5. ì¸ê¸° Published ë…¸íŠ¸ ì¡°íšŒ

```typescript
GET /popular/published?limit=ê²°ê³¼ìˆ˜
```

- **ëª©ì **: ì¸ê¸°ë„ ê¸°ë°˜ Published ë…¸íŠ¸ ëª©ë¡
- **ê¶Œí•œ**: ì„ íƒì  ë¡œê·¸ì¸ (OptionalAuthGuard)
- **ì •ë ¬**: ì¡°íšŒìˆ˜, ì¢‹ì•„ìš” ë“± ê¸°ì¤€ (í–¥í›„ êµ¬í˜„)

### 6. ìµœê·¼ Published ë…¸íŠ¸ ì¡°íšŒ

```typescript
GET /recent/published?limit=ê²°ê³¼ìˆ˜
```

- **ëª©ì **: ìµœê·¼ ë°œí–‰ëœ Published ë…¸íŠ¸ ëª©ë¡
- **ê¶Œí•œ**: ì„ íƒì  ë¡œê·¸ì¸ (OptionalAuthGuard)
- **ì •ë ¬**: ë°œí–‰ì¼ì‹œ ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ

## ğŸ—‘ï¸ ìƒíƒœ ê´€ë¦¬ ê¸°ëŠ¥

### 7. Published ìƒíƒœ í•´ì œ

```typescript
DELETE /:libraryName/unpublish
```

- **ëª©ì **: Published â†’ Private ìƒíƒœ ë³€ê²½
- **ê¶Œí•œ**: ë¡œê·¸ì¸ í•„ìˆ˜ (JwtAuthGuard)
- **ë™ì‘**:
  - DBì—ì„œ Published ë ˆì½”ë“œ ì‚­ì œ
  - GCSì—ì„œ published í´ë” ì‚­ì œ
  - Private í´ë”ëŠ” ìœ ì§€

---

# êµ¬í˜„ êµ¬ì¡°

## LibraryPublishedService

```typescript
class LibraryPublishedService {
  // ê¸°ë³¸ ê¸°ëŠ¥
  async getPublishedFileTree(userId, libraryName): ResponseFileTree;
  async unPublishedLibrary(userId, libraryName): void;

  // ì—°ê²° ê¸°ëŠ¥
  async linkToPublishedNote(
    fromUserId,
    fromLibraryName,
    toUserId,
    toLibraryName,
  ): void;
  async getLinkedNotes(userId, libraryName): any[];
  async unlinkNote(userId, libraryName, linkedNoteId): void;

  // ê²€ìƒ‰ ê¸°ëŠ¥
  async searchPublishedNotes(query, userId?, limit): any[];
  async getPopularPublishedNotes(limit): any[];
  async getRecentPublishedNotes(limit): any[];
}
```

## ê¶Œí•œ ì²´ê³„

- **JwtAuthGuard**: ì—°ê²° ê´€ë¦¬, ìƒíƒœ ë³€ê²½ (ë¡œê·¸ì¸ í•„ìˆ˜)
- **OptionalAuthGuard**: ì¡°íšŒ, ê²€ìƒ‰ (ë¡œê·¸ì¸ ì„ íƒ)

## í™•ì¥ ê³„íš

- Repository ë©”ì„œë“œ ì‹¤ì œ êµ¬í˜„ (í˜„ì¬ placeholder)
- ë…¸íŠ¸ ì—°ê²° DB ìŠ¤í‚¤ë§ˆ ì„¤ê³„
- ê²€ìƒ‰ ì¸ë±ì‹± ë° ì„±ëŠ¥ ìµœì í™”
- ë…¸íŠ¸ ìƒí˜¸ì‘ìš© ê¸°ëŠ¥ (ì¢‹ì•„ìš”, ì¡°íšŒìˆ˜ ë“±)
