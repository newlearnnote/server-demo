# Product Requirements Document (PRD)

## 프로젝트 개요

### 프로젝트명
NewLearn Note (NLN)

### 프로젝트 비전
복잡한 업로드 과정 없이 지식을 공유하고, 사용자 간 노트가 연결되어 네트워크를 형성하는 지식 공유 플랫폼

### 목표
- 옵시디언이나 노션과 같은 기존 툴의 높은 진입 장벽을 제거
- 로컬 파일 관리와 클라우드 동기화를 원클릭으로 해결
- 노트 간 연결을 통해 지식 네트워크를 시각화
- AI 기반 문서 분석 및 질의응답으로 학습 효율 향상

---

## 문제 정의

### 기존 솔루션의 한계
1. **높은 진입 장벽**: 옵시디언, 노션 등 기존 툴은 초기 설정과 사용법이 복잡함
2. **파일 관리의 어려움**: 로컬 파일과 클라우드 동기화가 번거로움
3. **지식 고립**: 개인 노트가 타인과 공유되지 않아 지식 네트워크 형성 불가
4. **문서 검색의 한계**: 키워드 검색만으로는 방대한 문서에서 원하는 정보를 찾기 어려움

### NewLearn Note의 해결 방안
- **원클릭 동기화**: Push/Pull 버튼 하나로 로컬 ↔ 서버 파일 동기화
- **간편한 발행**: Private 노트를 Published로 전환하여 타인과 공유
- **노트 네트워크**: 노트 간 링크를 통해 지식 연결망 형성
- **AI 질의응답**: 문서 내용을 학습한 AI에게 질문하여 빠르게 답변 획득

---

## 타겟 사용자

### Primary User
- 학습 노트를 체계적으로 관리하고 싶은 학생 및 직장인
- 지식을 타인과 공유하고 피드백을 받고 싶은 사용자
- 문서 기반 학습 시 AI 도움을 받고 싶은 사용자

### Secondary User
- 타인의 공개 노트를 참조하며 학습하고 싶은 사용자
- 특정 주제에 대한 연결된 노트 네트워크를 탐색하고 싶은 사용자

---

## 핵심 기능

### 1. 사용자 인증
**기능**: Google 소셜 로그인을 통한 간편 가입 및 로그인

**사용자 시나리오**:
- 사용자가 Google 계정으로 로그인
- 신규 사용자는 자동으로 계정 생성 및 프로필 설정
- JWT 토큰 기반 인증으로 웹 및 데스크톱 앱 모두 지원

---

### 2. Library 관리
**기능**: 노트를 그룹화하는 단위인 Library를 생성하고 관리

**사용자 시나리오**:
- 사용자가 주제별로 Library 생성 (예: "머신러닝 학습", "React 프로젝트")
- Library는 Private과 Published 두 가지 경로로 구분
  - **Private**: 사용자만 접근 가능한 비공개 파일
  - **Published**: 타인과 공유 가능한 공개 노트

---

### 3. Push/Pull (로컬 ↔ 서버 동기화)
**기능**: 로컬 파일과 서버를 동기화하여 클라우드 백업 및 협업 지원

**사용자 시나리오**:
- **Push**: 로컬의 여러 파일을 선택하여 서버에 업로드
  - 삭제된 파일 정보를 함께 전달하여 서버에서도 동기화
  - 파일은 Private 경로에 저장
- **Pull**: 서버의 Private 파일을 ZIP으로 압축하여 로컬에 다운로드
  - 파일명 한글 지원

---

### 4. 노트 발행 (Publish)
**기능**: Private 파일을 Published로 전환하여 타인과 공유

**사용자 시나리오**:
- 사용자가 Private 파일 중 공유하고 싶은 파일 선택
- Publish 버튼 클릭 시:
  - Private 파일이 Published 경로로 복사
  - 노트 엔터티 생성 (제목, 설명, 태그 등 메타데이터 입력)
  - 공개 URL 생성
- 발행된 노트는 타인이 조회 가능

---

### 5. 노트 네트워크 (Note Linking)
**기능**: 노트 간 링크를 생성하여 지식 연결망 형성

**사용자 시나리오**:
- 노트 A에서 노트 B를 참조하는 링크 생성
- 양방향 링크 지원:
  - **Linking Note**: 다른 노트를 참조하는 노트
  - **Linked Note**: 참조되는 노트
- 노트 네트워크를 시각화하여 지식 맵 확인 가능

---

### 6. 태그 및 북마크
**기능**: 노트를 분류하고 빠르게 접근

**사용자 시나리오**:
- 노트 생성 시 태그 추가 (예: #머신러닝, #Python)
- 중요한 노트를 북마크하여 빠른 접근
- 태그별, 북마크별 필터링

---

### 7. AI 문서 분석 및 질의응답 (RAG) - Premium 전용
**기능**: 업로드된 문서를 AI가 학습하여 질문에 답변 (Premium 플랜 필요)

**사용자 시나리오**:
- Premium 플랜 구독 사용자만 이용 가능
- 사용자가 PDF, Markdown, Text 파일을 업로드
- AI가 문서를 분석하고 벡터 데이터베이스에 저장
- 사용자가 문서 내용에 대해 질문
- AI가 문서 내용을 기반으로 답변 생성
- 채팅 히스토리 저장 및 조회

**지원 파일 형식**:
- PDF (.pdf)
- Markdown (.md)
- Text (.txt)

**AI 기능**:
- 문서 기반 질의응답
- 유사도 검색을 통한 관련 내용 추출
- 채팅 히스토리 무제한 저장 (Premium 전용)

---

## 보안 및 권한 관리

### Signed URL 전략
- 파일 접근 시 임시 Signed URL 생성 (15분 유효)
- 서버 부하 없이 클라이언트가 직접 Google Cloud Storage와 통신
- 만료 시간 기반 접근 권한으로 보안 강화

### 권한 관리
- **Private 파일**: Library 소유자만 접근 가능
- **Published 파일**: 누구나 접근 가능 (공개)
- JWT 기반 인증으로 사용자 검증
- Library Owner Guard를 통한 소유권 검증

---

## 기술 아키텍처 개요

### Backend 이원화 전략
- **NestJS (메인 서버)**:
  - 비즈니스 로직 및 데이터 정합성 관리
  - 사용자 인증, Library 관리, 노트 CRUD
  - 유지보수성과 확장성 중시

- **FastAPI (RAG 서버)**:
  - AI 추론 및 비동기 문서 처리
  - 문서 임베딩 생성 및 벡터 검색
  - 처리 효율 극대화

### 데이터베이스
- **PostgreSQL**: 사용자, 노트, Library 메타데이터
- **ChromaDB**: 문서 벡터 임베딩 저장 및 유사도 검색

### 파일 저장소
- **Google Cloud Storage (GCS)**: 모든 문서 파일 저장
- Signed URL을 통한 안전한 파일 접근

### AI 모델
- **OpenAI GPT-4o-mini**: 질의응답 생성
- **text-embedding-3-small**: 문서 임베딩 생성
- **LangChain**: RAG 파이프라인 구축

---

## 사용자 플로우

### 신규 사용자
1. Google 계정으로 로그인
2. Library 생성 (예: "머신러닝 학습")
3. 로컬 파일 Push하여 서버에 업로드
4. 공유하고 싶은 파일 Publish하여 노트 생성
5. 노트에 태그 추가 및 다른 노트와 링크 연결
6. AI에게 문서 내용 질문

### 기존 사용자
1. 로그인 후 Library 목록 확인
2. Pull하여 최신 파일을 로컬에 동기화
3. 로컬에서 파일 수정 후 다시 Push
4. 새로운 노트 Publish 또는 기존 노트 수정
5. 타인의 공개 노트 탐색 및 링크 연결

### AI 질의응답 사용자 (Premium 플랜 전용)
1. Premium 플랜 구독
2. 문서 업로드 (PDF, Markdown, Text)
3. AI가 문서 분석 완료 대기
4. 채팅 창에서 문서 내용에 대해 질문
5. AI 답변 확인 및 후속 질문
6. 채팅 히스토리 저장 및 나중에 다시 확인

---

## 성공 지표

### 사용자 참여도
- 월간 활성 사용자 수 (MAU)
- Library 생성 수
- 노트 Publish 수
- 노트 링크 생성 수

### 수익 지표
- Free → Basic 전환율
- Free/Basic → Premium 전환율
- 월간 반복 수익 (MRR)
- 고객 평생 가치 (LTV)
- 이탈률 (Churn Rate)

### AI 사용률 (Premium 사용자)
- 문서 업로드 수
- AI 질의응답 사용 빈도
- 채팅 세션 길이
- AI 기능 사용자 만족도

### 지식 네트워크
- 전체 노트 수
- 노트 간 연결 수
- 공개 노트 조회 수

---

## 요금제 및 플랜

### Free (무료)
**가격**: 무료

**제공 기능**:
- Library 생성: 1개
- 클라우드 저장 용량: 500MB
- 노트 발행 (Publish): 가능
- 노트 네트워크 (Linking): 가능
- 태그 및 북마크: 가능
- AI 문서 분석 및 질의응답: 불가능

**제한 사항**:
- 로컬-서버 동기화는 1개의 Library만 사용 가능
- AI 어시스턴스 기능 사용 불가

---

### Basic (베이직)
**가격**: $5/월

**제공 기능**:
- Library 생성: 무제한
- 클라우드 저장 용량: 5GB (전체 Library 합산)
- 노트 발행 (Publish): 가능
- 노트 네트워크 (Linking): 가능
- 태그 및 북마크: 가능
- AI 문서 분석 및 질의응답: 불가능

**업그레이드 혜택**:
- Library를 무제한으로 생성하여 주제별 프로젝트 관리
- 총 5GB의 클라우드 저장 공간으로 더 많은 문서 관리

---

### Premium (프리미엄)
**가격**: $10/월

**제공 기능**:
- Library 생성: 무제한
- 클라우드 저장 용량: 10GB (전체 Library 합산)
- 노트 발행 (Publish): 가능
- 노트 네트워크 (Linking): 가능
- 태그 및 북마크: 가능
- AI 문서 분석 및 질의응답: 가능

**프리미엄 전용 기능**:
- AI 어시스턴스를 통한 문서 기반 질의응답
- 채팅 히스토리 무제한 저장
- 우선 지원

---

### 플랜 비교표

| 기능 | Free | Basic | Premium |
|------|------|-------|---------|
| **가격** | 무료 | $5/월 | $10/월 |
| **Library 개수** | 1개 | 무제한 | 무제한 |
| **클라우드 저장 용량** | 500MB | 5GB | 10GB |
| **노트 발행** | O | O | O |
| **노트 네트워크** | O | O | O |
| **태그/북마크** | O | O | O |
| **AI 어시스턴스** | X | X | O |
| **채팅 히스토리** | - | - | 무제한 |

---

## 향후 계획

### Phase 1 (현재)
- 기본 노트 관리 및 Library 시스템
- Push/Pull 동기화
- Private/Published 발행 시스템
- AI 문서 질의응답

### Phase 2 (예정)
- 노트 네트워크 시각화 UI
- 협업 기능 (노트 공동 편집)
- 멀티미디어 지원 (이미지, 동영상)
- 모바일 앱 지원

### Phase 3 (예정)
- 엔터프라이즈 플랜 (팀 워크스페이스, 고급 AI 모델)
- API 공개 (써드파티 통합)
- 고급 검색 및 필터링
- 협업 권한 관리 및 역할 기반 접근 제어

---

## 제약 사항

### 플랜별 제약 사항
- **Free 플랜**:
  - Library 개수: 1개
  - 클라우드 저장 용량: 500MB
  - AI 어시스턴스 사용 불가

- **Basic 플랜**:
  - Library 개수: 무제한
  - 클라우드 저장 용량: 5GB (전체 합산)
  - AI 어시스턴스 사용 불가

- **Premium 플랜**:
  - Library 개수: 무제한
  - 클라우드 저장 용량: 10GB (전체 합산)
  - AI 어시스턴스 사용 가능

### 파일 업로드
- 지원 파일 형식: PDF, Markdown, Text
- 최대 파일 크기: 50MB (단일 파일)

### AI 질의응답 (Premium 플랜 전용)
- 문서당 최대 청크 수: 설정 가능 (기본 1000 토큰)
- 동시 채팅 세션 제한: 사용자당 제한 없음 (서버 리소스에 따라 조정)

### 보안
- Signed URL 유효 시간: 15분
- JWT 토큰 만료 시간: 설정 가능

---

## 용어 정리

- **Library**: 노트를 그룹화하는 단위 (프로젝트 또는 주제별)
- **Private**: 사용자만 접근 가능한 비공개 파일 경로
- **Published**: 타인과 공유 가능한 공개 노트 경로
- **Push**: 로컬 파일을 서버에 업로드
- **Pull**: 서버 파일을 로컬에 다운로드
- **Publish**: Private 파일을 Published로 전환하여 노트 생성
- **Note Network**: 노트 간 링크 연결
- **Linking Note**: 다른 노트를 참조하는 노트
- **Linked Note**: 참조되는 노트
- **RAG (Retrieval-Augmented Generation)**: 문서 기반 AI 질의응답 파이프라인
- **Signed URL**: 임시 접근 권한이 부여된 URL (보안 강화)
